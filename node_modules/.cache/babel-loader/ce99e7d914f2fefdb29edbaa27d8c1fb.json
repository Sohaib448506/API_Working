{"ast":null,"code":"var _s2 = $RefreshSig$();\n\nimport React, { useEffect, useContext } from 'react';\nimport { getUser } from '../api/apiBasicAuth';\nimport { CancelToken } from 'apisauce';\nimport { AppContext } from '../context/AppContext';\nimport { useNavigate } from 'react-router-dom';\nexport default function useLogin(loginCreds, setLoginCreds, setError) {\n  _s2();\n\n  var _s = $RefreshSig$();\n\n  const navigate = useNavigate();\n\n  _s(useEffect(_s(() => {\n    _s();\n\n    const source = CancelToken.source();\n    const {\n      setUser\n    } = useContext(AppContext);\n\n    if (loginCreds.email && loginCreds.password) {\n      const login = async (cancelToken, loginCreds) => {\n        var _response$user;\n\n        const response = await getUser(loginCreds.email, loginCreds.password, cancelToken);\n        console.log(response);\n\n        if ((_response$user = response.user) !== null && _response$user !== void 0 && _response$user.token) {\n          console.log('logged in');\n          setUser(response.user);\n          setLoginCreds({});\n          navigate('/');\n        } // navigate to the home page\n\n\n        setError(response.error);\n      };\n\n      login(source.token, loginCreds);\n    }\n\n    return () => {\n      source.cancel();\n    };\n  }, \"ilxd0phQ4q+67y3glLXKwhNhMvA=\"), [loginCreds, setLoginCreds, setError, navigate]), \"ilxd0phQ4q+67y3glLXKwhNhMvA=\");\n}\n\n_s2(useLogin, \"0pNeyzXk/ByIxyERsdaIrG6js9s=\", false, function () {\n  return [useNavigate];\n});","map":{"version":3,"names":["React","useEffect","useContext","getUser","CancelToken","AppContext","useNavigate","useLogin","loginCreds","setLoginCreds","setError","navigate","source","setUser","email","password","login","cancelToken","response","console","log","user","token","error","cancel"],"sources":["/home/sohaib/Desktop/Practice/bookStore/React_bookstore/src/hooks/useLogin.js"],"sourcesContent":["import React, {useEffect, useContext} from 'react'\nimport {getUser} from '../api/apiBasicAuth';\nimport { CancelToken } from 'apisauce';\nimport {AppContext} from '../context/AppContext';\nimport {useNavigate} from 'react-router-dom';\n\nexport default function useLogin(loginCreds, setLoginCreds, setError) {\n\nconst navigate = useNavigate()  \nuseEffect(\n        ()=>{\n                const source = CancelToken.source()\n                const {setUser} = useContext(AppContext)\n                if (loginCreds.email && loginCreds.password){\n                    const login = async (cancelToken, loginCreds)=>{\n                    const response = await getUser(loginCreds.email, loginCreds.password,cancelToken)\n                    console.log(response)\n                    if(response.user?.token){\n                        console.log('logged in');\n                        setUser(response.user);\n                        setLoginCreds({})\n                        navigate('/')\n                    }    // navigate to the home page\n                    setError(response.error);\n                        \n                }    \n                login(source.token, loginCreds);\n            \n            }\n            return ()=>{source.cancel()}\n        },\n        [loginCreds,  setLoginCreds, setError, navigate]\n    )\n    \n}"],"mappings":";;AAAA,OAAOA,KAAP,IAAeC,SAAf,EAA0BC,UAA1B,QAA2C,OAA3C;AACA,SAAQC,OAAR,QAAsB,qBAAtB;AACA,SAASC,WAAT,QAA4B,UAA5B;AACA,SAAQC,UAAR,QAAyB,uBAAzB;AACA,SAAQC,WAAR,QAA0B,kBAA1B;AAEA,eAAe,SAASC,QAAT,CAAkBC,UAAlB,EAA8BC,aAA9B,EAA6CC,QAA7C,EAAuD;EAAA;;EAAA;;EAEtE,MAAMC,QAAQ,GAAGL,WAAW,EAA5B;;EACA,GAAAL,SAAS,IACD,MAAI;IAAA;;IACI,MAAMW,MAAM,GAAGR,WAAW,CAACQ,MAAZ,EAAf;IACA,MAAM;MAACC;IAAD,IAAYX,UAAU,CAACG,UAAD,CAA5B;;IACA,IAAIG,UAAU,CAACM,KAAX,IAAoBN,UAAU,CAACO,QAAnC,EAA4C;MACxC,MAAMC,KAAK,GAAG,OAAOC,WAAP,EAAoBT,UAApB,KAAiC;QAAA;;QAC/C,MAAMU,QAAQ,GAAG,MAAMf,OAAO,CAACK,UAAU,CAACM,KAAZ,EAAmBN,UAAU,CAACO,QAA9B,EAAuCE,WAAvC,CAA9B;QACAE,OAAO,CAACC,GAAR,CAAYF,QAAZ;;QACA,sBAAGA,QAAQ,CAACG,IAAZ,2CAAG,eAAeC,KAAlB,EAAwB;UACpBH,OAAO,CAACC,GAAR,CAAY,WAAZ;UACAP,OAAO,CAACK,QAAQ,CAACG,IAAV,CAAP;UACAZ,aAAa,CAAC,EAAD,CAAb;UACAE,QAAQ,CAAC,GAAD,CAAR;QACH,CAR8C,CAQ1C;;;QACLD,QAAQ,CAACQ,QAAQ,CAACK,KAAV,CAAR;MAEH,CAXG;;MAYJP,KAAK,CAACJ,MAAM,CAACU,KAAR,EAAed,UAAf,CAAL;IAEH;;IACD,OAAO,MAAI;MAACI,MAAM,CAACY,MAAP;IAAgB,CAA5B;EACH,CArBA,mCAsBD,CAAChB,UAAD,EAAcC,aAAd,EAA6BC,QAA7B,EAAuCC,QAAvC,CAtBC,CAAT;AAyBC;;IA5BuBJ,Q;UAEPD,W"},"metadata":{},"sourceType":"module"}