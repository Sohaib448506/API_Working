{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport React, { useEffect, useContext } from \"react\";\nimport { getUser } from \"../api/apiBasicAuth\";\nimport { CancelToken } from \"apisauce\";\nimport { AppContext } from \"../context/AppContext\";\nimport { useNavigate } from \"react-router-dom\";\nexport default function useLogin(loginCreds, setLoginCreds, setError) {\n  _s();\n\n  const navigate = useNavigate();\n  const {\n    setUser\n  } = useContext(AppContext);\n  useEffect(() => {\n    const source = CancelToken.source();\n\n    if (loginCreds.email && loginCreds.password) {\n      const login = async (cancelToken, loginCreds) => {\n        var _response$user;\n\n        const response = await getUser(loginCreds.email, loginCreds.password, cancelToken);\n        console.log(response);\n\n        if ((_response$user = response.user) !== null && _response$user !== void 0 && _response$user.token) {\n          console.log(\"logged in\");\n          setUser(response.user);\n          setLoginCreds({});\n          navigate(\"/\");\n        } // navigate to the home page\n\n\n        setError(response.error);\n      };\n\n      login(source.token, loginCreds);\n    }\n\n    return () => {\n      source.cancel();\n    };\n  }, [loginCreds, setLoginCreds, setError, navigate]);\n}\n\n_s(useLogin, \"r+2w4KZOqVH/dQYSTK+G6HgUxXw=\", false, function () {\n  return [useNavigate];\n});","map":{"version":3,"names":["React","useEffect","useContext","getUser","CancelToken","AppContext","useNavigate","useLogin","loginCreds","setLoginCreds","setError","navigate","setUser","source","email","password","login","cancelToken","response","console","log","user","token","error","cancel"],"sources":["/home/sohaib/Desktop/Practice/bookStore/React_bookstore/src/hooks/useLogin.js"],"sourcesContent":["import React, { useEffect, useContext } from \"react\";\nimport { getUser } from \"../api/apiBasicAuth\";\nimport { CancelToken } from \"apisauce\";\nimport { AppContext } from \"../context/AppContext\";\nimport { useNavigate } from \"react-router-dom\";\n\nexport default function useLogin(loginCreds, setLoginCreds, setError) {\n  const navigate = useNavigate();\n  const { setUser } = useContext(AppContext);\n  useEffect(() => {\n    const source = CancelToken.source();\n\n    if (loginCreds.email && loginCreds.password) {\n      const login = async (cancelToken, loginCreds) => {\n        const response = await getUser(\n          loginCreds.email,\n          loginCreds.password,\n          cancelToken\n        );\n        console.log(response);\n        if (response.user?.token) {\n          console.log(\"logged in\");\n          setUser(response.user);\n          setLoginCreds({});\n          navigate(\"/\");\n        } // navigate to the home page\n        setError(response.error);\n      };\n      login(source.token, loginCreds);\n    }\n    return () => {\n      source.cancel();\n    };\n  }, [loginCreds, setLoginCreds, setError, navigate]);\n}\n"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,UAA3B,QAA6C,OAA7C;AACA,SAASC,OAAT,QAAwB,qBAAxB;AACA,SAASC,WAAT,QAA4B,UAA5B;AACA,SAASC,UAAT,QAA2B,uBAA3B;AACA,SAASC,WAAT,QAA4B,kBAA5B;AAEA,eAAe,SAASC,QAAT,CAAkBC,UAAlB,EAA8BC,aAA9B,EAA6CC,QAA7C,EAAuD;EAAA;;EACpE,MAAMC,QAAQ,GAAGL,WAAW,EAA5B;EACA,MAAM;IAAEM;EAAF,IAAcV,UAAU,CAACG,UAAD,CAA9B;EACAJ,SAAS,CAAC,MAAM;IACd,MAAMY,MAAM,GAAGT,WAAW,CAACS,MAAZ,EAAf;;IAEA,IAAIL,UAAU,CAACM,KAAX,IAAoBN,UAAU,CAACO,QAAnC,EAA6C;MAC3C,MAAMC,KAAK,GAAG,OAAOC,WAAP,EAAoBT,UAApB,KAAmC;QAAA;;QAC/C,MAAMU,QAAQ,GAAG,MAAMf,OAAO,CAC5BK,UAAU,CAACM,KADiB,EAE5BN,UAAU,CAACO,QAFiB,EAG5BE,WAH4B,CAA9B;QAKAE,OAAO,CAACC,GAAR,CAAYF,QAAZ;;QACA,sBAAIA,QAAQ,CAACG,IAAb,2CAAI,eAAeC,KAAnB,EAA0B;UACxBH,OAAO,CAACC,GAAR,CAAY,WAAZ;UACAR,OAAO,CAACM,QAAQ,CAACG,IAAV,CAAP;UACAZ,aAAa,CAAC,EAAD,CAAb;UACAE,QAAQ,CAAC,GAAD,CAAR;QACD,CAZ8C,CAY7C;;;QACFD,QAAQ,CAACQ,QAAQ,CAACK,KAAV,CAAR;MACD,CAdD;;MAeAP,KAAK,CAACH,MAAM,CAACS,KAAR,EAAed,UAAf,CAAL;IACD;;IACD,OAAO,MAAM;MACXK,MAAM,CAACW,MAAP;IACD,CAFD;EAGD,CAxBQ,EAwBN,CAAChB,UAAD,EAAaC,aAAb,EAA4BC,QAA5B,EAAsCC,QAAtC,CAxBM,CAAT;AAyBD;;GA5BuBJ,Q;UACLD,W"},"metadata":{},"sourceType":"module"}